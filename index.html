<!DOCTYPE html>
<html lang="en" class="bg-slate-900 text-white">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>New World PvP Track Rewards</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Custom styles -->
  <link rel="stylesheet" href="style.css" />
</head>

<body class="bg-gradient-to-br from-slate-950 via-slate-900 to-slate-800 text-slate-100 min-h-screen py-10">
  <main class="max-w-7xl mx-auto px-4 space-y-10">

    <!-- SETTINGS PANEL -->
    <section class="rounded-2xl border border-slate-700/60 bg-slate-800/60 shadow-xl shadow-black/60">
      <div class="p-6">
        <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-4">
          <div>
            <h1 class="text-2xl font-bold text-slate-100">
              New World · <span class="text-indigo-400">PvP Track Reward Explorer</span>
            </h1>
            <p class="text-[12px] text-slate-400 leading-relaxed mt-1">
              See your real odds of getting each reward at your current PvP Track level.
            </p>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 w-full sm:w-auto">
            <div>
              <label for="playerLevelInput" class="block text-xs text-slate-300 mb-1 font-medium">
                Player Level
              </label>
              <input
                id="playerLevelInput"
                type="number"
                min="1"
                max="70"
                value="70"
                class="w-full rounded-lg bg-slate-900/70 border border-slate-600 text-slate-100 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"
                aria-label="Your character level (1 to 70)"
              />
            </div>

            <div>
              <label for="trackLevelInput" class="block text-xs text-slate-300 mb-1 font-medium">
                PvP Track Level
              </label>
              <input
                id="trackLevelInput"
                type="number"
                min="0"
                max="200"
                value="200"
                class="w-full rounded-lg bg-slate-900/70 border border-slate-600 text-slate-100 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"
                aria-label="Your PvP Track rank (0 to 200)"
              />
            </div>

            <div class="flex items-end">
              <button
                id="calcBtn"
                class="w-full bg-indigo-600 hover:bg-indigo-500 active:bg-indigo-700 text-white font-semibold rounded-lg px-4 py-2 text-sm shadow-lg shadow-indigo-900/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-400 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900 transition-colors"
                aria-label="Recalculate probabilities"
              >
                Update
              </button>
            </div>
          </div>
        </div>

        <!-- SEARCH -->
        <div class="sm:col-span-3 mt-4">
          <div class="flex gap-2">
            <input
              id="searchInput"
              type="text"
              placeholder="Search — Name / RewardId / LTID / LBID / ItemId"
              class="w-full rounded-lg bg-slate-900/70 border border-slate-600 text-slate-100 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"
              aria-label="Search by RewardId, LTID, LBID, ItemId or display name"
            />
            <button
              id="searchBtn"
              class="bg-slate-700 hover:bg-slate-600 active:bg-slate-800 text-white font-semibold rounded-lg px-4 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-400 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900 transition-colors whitespace-nowrap"
              aria-label="Run search"
            >
              Search
            </button>
          </div>
        </div>



        <!-- META / SUMMARY -->
        <div class="mt-4 rounded-xl p-4 bg-slate-900/30 border border-slate-700/60">
          <!-- cards injected by JS -->
          <div
            id="resultMeta"
            class="grid gap-4 sm:grid-cols-2 lg:grid-cols-4 text-[12px] leading-tight"
          ></div>

          <!-- helper text -->
          <div class="mt-4 flex flex-col sm:flex-row sm:flex-wrap gap-3 text-[11px] text-slate-400 leading-relaxed">
            <div class="flex items-start gap-2">
              <span class="text-slate-300 font-semibold">•</span>
              <span>Each row is a possible reward for your current PvP Track level.</span>
            </div>
            <div class="flex items-start gap-2">
              <span class="text-slate-300 font-semibold">•</span>
              <span>Click an item name to drill down: LTID → LBID → final items (with exact odds).</span>
            </div>
            <div class="flex items-start gap-2">
              <span class="text-slate-300 font-semibold">•</span>
              <span>Use “Owned?” to hide cosmetics / artifacts you already have. Stored locally only.</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- MAIN TABLE -->
    <section class="rounded-2xl border border-slate-700/60 bg-slate-800/60 shadow-xl shadow-black/60">
      <div class="p-4">
        <h2 class="text-xl font-bold text-slate-100 mb-3">
          Available rewards
        </h2>

        <table class="w-full table-auto text-left text-[13px] text-slate-200">
          <thead class="uppercase text-[10px] text-slate-200 sticky top-0 z-20">
            <tr class="bg-slate-900">
              <!-- Owned? -->
              <th rowspan="2"
                  class="px-2 py-2 font-semibold text-center border-b border-slate-700/60 w-[3rem]">
                Owned?
              </th>

              <!-- Icon -->
              <th rowspan="2"
                  class="px-2 py-2 font-semibold text-center border-b border-slate-700/60 w-[3rem]">
                Icon
              </th>

              <!-- Item -->
              <th rowspan="2"
                  class="px-2 py-2 font-semibold border-b border-slate-700/60"
                  data-sort-key="displayName">
                Item
                <span class="sort-arrows"><span class="arrow-up">▲</span><span class="arrow-down">▼</span></span>
              </th>

              <!-- Azoth Salt -->
              <th rowspan="2"
                  class="px-2 py-2 font-semibold text-right border-b border-slate-700/60"
                  data-sort-key="cost">
                Azoth Salt
                <span class="sort-arrows"><span class="arrow-up">▲</span><span class="arrow-down">▼</span></span>
              </th>


              <!-- Notch 1 (group, sortable as a block on n1PctAny) -->
              <th colspan="3"
                  class="px-2 py-2 font-semibold text-center border-b border-slate-700/60 th-notch n1"
                  data-sort-key="n1PctAny">
                Notch 1
                <span class="sort-arrows"><span class="arrow-up">▲</span><span class="arrow-down">▼</span></span>
              </th>

              <!-- Notch 2 -->
              <th colspan="3"
                  class="px-2 py-2 font-semibold text-center border-b border-slate-700/60 th-notch n2"
                  data-sort-key="n2PctAny">
                Notch 2
                <span class="sort-arrows"><span class="arrow-up">▲</span><span class="arrow-down">▼</span></span>
              </th>

              <!-- Notch 3 -->
              <th colspan="3"
                  class="px-2 py-2 font-semibold text-center border-b border-slate-700/60 th-notch n3"
                  data-sort-key="n3PctAny">
                Notch 3
                <span class="sort-arrows"><span class="arrow-up">▲</span><span class="arrow-down">▼</span></span>
              </th>

              <!-- %Track1/9 -->
              <th rowspan="2"
                  class="px-2 py-2 font-semibold text-right border-b border-slate-700/60 th-track"
                  data-sort-key="trackPct">
                %Track1/9
                <span class="sort-arrows"><span class="arrow-up">▲</span><span class="arrow-down">▼</span></span>
              </th>
            </tr>

            <tr class="bg-slate-900">
              <!-- Subcolumns for Notch 1 -->
              <th class="px-2 py-1 font-semibold text-right border-b border-slate-700/60 subhead n1">Weight</th>
              <th class="px-2 py-1 font-semibold text-right border-b border-slate-700/60 subhead n1">% single</th>
              <th class="px-2 py-1 font-semibold text-right border-b border-slate-700/60 subhead n1">% ≥1/3</th>

              <!-- Subcolumns for Notch 2 -->
              <th class="px-2 py-1 font-semibold text-right border-b border-slate-700/60 subhead n2">Weight</th>
              <th class="px-2 py-1 font-semibold text-right border-b border-slate-700/60 subhead n2">% single</th>
              <th class="px-2 py-1 font-semibold text-right border-b border-slate-700/60 subhead n2">% ≥1/3</th>

              <!-- Subcolumns for Notch 3 -->
              <th class="px-2 py-1 font-semibold text-right border-b border-slate-700/60 subhead n3">Weight</th>
              <th class="px-2 py-1 font-semibold text-right border-b border-slate-700/60 subhead n3">% single</th>
              <th class="px-2 py-1 font-semibold text-right border-b border-slate-700/60 subhead n3">% ≥1/3</th>
            </tr>
          </thead>

          <tbody id="resultsBodyAll">
            <!-- filled by JS -->
          </tbody>
        </table>
      </div>
    </section>

    <!-- OWNED LIST -->
    <section id="ownedWrapper" class="hidden rounded-2xl border border-slate-700/60 bg-slate-800/60 shadow-xl shadow-black/60">
      <div class="p-6">
        <h2 class="text-xl font-bold text-slate-100 mb-3">
          Already owned
          <span class="text-xs text-slate-400 font-normal">
            · tracking
            <span id="ownedCount" class="font-mono text-amber-300">0</span>
            unique rewards
          </span>
        </h2>

        <div class="rounded-lg border border-slate-700/60 bg-slate-900/40">
          <table class="w-full table-auto text-left text-sm text-slate-200">
            <thead class="uppercase text-[10px] text-slate-300 bg-slate-900 sticky top-0 z-10">
            <tr>
              <th class="px-3 py-2 font-semibold text-center w-[2.5rem]">Icon</th>
              <th class="px-3 py-2 font-semibold">Item</th>
              <th class="px-3 py-2 font-semibold text-right w-[3rem]"> </th>
            </tr>
            </thead>
            <tbody id="ownedBody" class="text-[13px]">
              <!-- filled in JS -->
            </tbody>
          </table>
        </div>

        <p class="text-[11px] text-slate-500 mt-3">
          This table is locally stored, click on the X to bring them back in the calculations.
        </p>
      </div>
    </section>

  </main>

  <script src="data.js"></script>
  <script src="pvp.js"></script>
</body>
</html>
